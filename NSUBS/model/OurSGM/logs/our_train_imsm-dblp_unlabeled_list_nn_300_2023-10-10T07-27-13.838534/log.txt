Critical! Fix random seed for torch and numpy
Take 5 out of 200 query graphs
Saved target graph (OurGraph) to /home/kli16/NSUBS/model/OurSGM/save/imsm-dblp_unlabeled_dense_64/target.pickle
Loaded gp, gq, gt_filtered from /home/kli16/NSUBS/model/OurSGM/save/imsm-dblp_unlabeled_dense_64/0p_pqf.pickle


--- Query 0/5: /home/kli16/NSUBS/model/SubgraphMatching/dataset/dblp_unlabeled/query_graph/query_dense_64_1.graph
gq 10 nodes 10 edges (avg degree 1.0000) 4 node labels
gt 40 nodes 75 edges (avg degree 1.8750) 4 node labels
Merged loader: dense_64 0
Take 5 out of 200 query graphs
Saved target graph (OurGraph) to /home/kli16/NSUBS/model/OurSGM/save/imsm-dblp_unlabeled_dense_64/target.pickle
Loaded gp, gq, gt_filtered from /home/kli16/NSUBS/model/OurSGM/save/imsm-dblp_unlabeled_dense_64/99p_pqf.pickle


--- Query 0/5: /home/kli16/NSUBS/model/SubgraphMatching/dataset/dblp_unlabeled/query_graph/query_dense_64_100.graph
gq 10 nodes 10 edges (avg degree 1.0000) 5 node labels
gt 17 nodes 25 edges (avg degree 1.4706) 5 node labels
Traceback (most recent call last):
  File "/home/kli16/NSUBS/model/OurSGM/main.py", line 446, in <module>
    main()
  File "/home/kli16/NSUBS/model/OurSGM/main.py", line 410, in main
    train(model, FLAGS.num_iters_threshold, FLAGS.timeout, logger)
  File "/home/kli16/NSUBS/model/OurSGM/train.py", line 132, in train
    cur_best_metric = update_validation_set(model, logger, total_play_id, -1, 0)
  File "/home/kli16/NSUBS/model/OurSGM/train.py", line 105, in update_validation_set
    metrics = test(model, FLAGS.num_iters_threshold_val, FLAGS.timeout_val, logger, total_play_id, test_loader=val_loader)
  File "/home/kli16/NSUBS/model/OurSGM/test.py", line 77, in test
    smts.search(gq, gt, f'{i}_test', model, CS, daf_path_weights, FLAGS.MCTS_test, logger=logger, align_matrix=align_matrix)
  File "/home/kli16/NSUBS/model/OurSGM/search.py", line 221, in search
    true_nn_map=true_nn_map, align_matrix=align_matrix
  File "/home/kli16/NSUBS/model/OurSGM/search.py", line 275, in _search
    r = self._run_single_iteration(cur_node, global_search_params)
  File "/home/kli16/NSUBS/model/OurSGM/search.py", line 465, in _run_single_iteration
    additional_node_attributes=node_attrib
  File "/home/kli16/NSUBS/model/OurSGM/search.py", line 403, in execute_action
    next_node = self._get_next_node(cur_node, global_search_params, u, v,)
  File "/home/kli16/NSUBS/model/OurSGM/search.py", line 718, in _get_next_node
    out, candidate_map = self._get_next_u_and_vli(global_search_params, nn_map_new, filter_key)
  File "/home/kli16/NSUBS/model/OurSGM/search.py", line 775, in _get_next_u_and_vli
    out = self.compute_u_v_score_wrapper(global_search_params, nn_map, candidate_map, filter_key)
  File "/home/kli16/NSUBS/model/OurSGM/search.py", line 823, in compute_u_v_score_wrapper
    eps=eps, align_matrix=align_matrix, query_tree=query_tree
  File "/home/kli16/NSUBS/model/OurSGM/search.py", line 956, in get_v_score_li
    query_tree=query_tree
  File "/home/kli16/miniconda3/envs/NSUBS_env/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/kli16/NSUBS/model/OurSGM/dvn_wrapper.py", line 86, in forward
    execute_action, query_tree, u=u, v_li=v_li
  File "/home/kli16/miniconda3/envs/NSUBS_env/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/kli16/NSUBS/model/OurSGM/dvn.py", line 72, in forward
    node_mask, cache_embeddings,
  File "/home/kli16/NSUBS/model/OurSGM/dvn.py", line 42, in encoder_wrapper
    cache_target_embeddings
  File "/home/kli16/miniconda3/envs/NSUBS_env/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/kli16/NSUBS/model/OurSGM/dvn_encoder.py", line 185, in forward
    assert False, 'did you really mean to only use intra-graph message passing?'
AssertionError: did you really mean to only use intra-graph message passing?

Total time: 27.134 secs
/home/kli16/NSUBS/model/OurSGM/logs/our_train_imsm-dblp_unlabeled_list_nn_300_2023-10-10T07-27-13.838534
our_train_imsm-dblp_unlabeled_list_nn_300_2023-10-10T07-27-13.838534
